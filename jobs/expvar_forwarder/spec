---
name: expvar_forwarder

templates:
  bpm.yml.erb: config/bpm.yml
  ca.crt.erb: config/certs/ca.crt
  forwarder.crt.erb: config/certs/forwarder.crt
  forwarder.key.erb: config/certs/forwarder.key

packages:
- expvar_forwarder

properties:
  log_agent.addr:
    description: |
      The Loggregator ingress address. This is the gRPC host that metrics will
      be written to.
    default: 127.0.0.1:3458
  log_agent.ca_cert:
    description: |
      The Loggregator CA certificate in PEM format.
  log_agent.client_cert
    description: |
      The client certificate used to connect to the Loggregator Agent.
  log_agent.client_key
    description: |
      The client private key used to connect to the Loggregator Agent.

  default_source_id:
    description: |
      Source ID to use for reported metrics when none is provided.
  interval:
    description: |
      How often the expvar-forwarder should scrape registered
      endpoints and report values.
    default: 1m
  counters:
    description: |
        An array of Objects that have the following fields:
        - addr: address of the expvar endpoint
        - name: The output name of the Counter
        - source_id: The output sourceID of the Counter
        - template: The golang text/template to find the metric in the expvar
          output.
        - tags: An object that can only have string values. They will be
          passed as tags on the envelope.
    default: []
  gauges:
    description: |
        An array of Objects that have the following fields:
        - addr: address of the expvar endpoint
        - name: The output name of the Counter
        - unit: The output unit of the Counter
        - source_id: The output sourceID of the Counter
        - template: The golang text/template to find the metric in the expvar
          output.
        - tags: An object that can only have string values. They will be
          passed as tags on the envelope.
    default: []
